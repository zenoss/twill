#! /usr/bin/env python2.3
#
# This file is part of the twill source distribution.
#
# twill is a extensible scriptlet language for testing Web apps,
# available at http://www.idyll.org/~t/www-tools/twill.html.
#
# Contact author: C. Titus Brown, titus@caltech.edu.
#
# This program and all associated source code files are Copyright (C)
# 2005 by C. Titus Brown.  It is under the Lesser GNU Public License;
# please see the included LICENSE.txt file for more information, or
# contact Titus directly.

"""
twill shell.
"""

import sys
from twill import TwillCommandLoop, execute_file, __version__

# If run from the command line, find & run any scripts put on the command
# line.  If none, drop into an interactive AutoShell.

if __name__ == '__main__':
    if len(sys.argv[1:]):
        success = []
        failure = []
        for filename in sys.argv[1:]:
            print '>> EXECUTING FILE', filename

            try:
                execute_file(filename)
                success.append(filename)
            except:
                failure.append(filename)
		raise

        print '--'
        print '%d of %d files SUCCEEDED.' % (len(success), len(sys.argv) - 1)
        if len(failure):
            print 'Failed:\n\t',
            print "\n\t".join(failure)
                                                
    else:
	welcome_msg = "\n -= Welcome to twill! =-\n"
	TwillCommandLoop().cmdloop(welcome_msg)
