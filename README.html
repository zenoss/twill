<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.3.7: http://docutils.sourceforge.net/" />
<title>twill: an extensible scriptlet language for testing web apps</title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<div class="document" id="twill-an-extensible-scriptlet-language-for-testing-web-apps">
<h1 class="title">twill: an extensible scriptlet language for testing web apps</h1>
<div class="contents topic" id="contents">
<p class="topic-title first"><a name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#what-is-twill" id="id1" name="id1">What is 'twill'?</a></li>
<li><a class="reference" href="#command-reference" id="id2" name="id2">Command Reference</a><ul>
<li><a class="reference" href="#browsing" id="id3" name="id3">Browsing</a></li>
<li><a class="reference" href="#assertions" id="id4" name="id4">Assertions</a></li>
<li><a class="reference" href="#display" id="id5" name="id5">Display</a></li>
<li><a class="reference" href="#forms" id="id6" name="id6">Forms</a></li>
<li><a class="reference" href="#other-commands" id="id7" name="id7">Other commands</a></li>
</ul>
</li>
<li><a class="reference" href="#availability" id="id8" name="id8">Availability</a></li>
<li><a class="reference" href="#installation-and-examples" id="id9" name="id9">Installation and Examples</a></li>
<li><a class="reference" href="#implementation-and-extending-twill" id="id10" name="id10">Implementation and Extending Twill</a></li>
<li><a class="reference" href="#why-reimplement-pbp" id="id11" name="id11">Why Reimplement PBP?</a></li>
<li><a class="reference" href="#future-plans" id="id12" name="id12">Future Plans</a></li>
<li><a class="reference" href="#acknowledgements-and-credits" id="id13" name="id13">Acknowledgements and Credits</a></li>
</ul>
</div>
<div class="section" id="what-is-twill">
<h1><a class="toc-backref" href="#id1" name="what-is-twill">What is 'twill'?</a></h1>
<p>twill is a reimplementation of <a class="reference" href="http://pbp.berlios.de/">PBP</a>, the &quot;Python Browser Poseur&quot;.
twill and PBP both let you execute scripts that looks something like
this:</p>
<pre class="literal-block">
# go to my Quixote demo page
go http://issola.caltech.edu/~t/qwsgi/qwsgi-demo.cgi/

# go to the widgets sub-page
go ./widgets
showform

# fill out the form
formclear 1
fv 1 name test
fv 1 password testpass
fv 1 confirm yes
showform

# submit form
submit 0

# show results
show

# confirm success, etc.
code 200
find testpass
</pre>
<p>The primary use for twill (as with PBP) is to do automated testing of
Web applications via a straightforward declarative language.  In
addition to basic Web crawling, I wanted to be able to extend the
language via Python, and I also wanted to be able to record things
with <a class="reference" href="http://maxq.tigris.org/">maxq</a>.  Hence, twill.</p>
</div>
<div class="section" id="command-reference">
<h1><a class="toc-backref" href="#id2" name="command-reference">Command Reference</a></h1>
<div class="section" id="browsing">
<h2><a class="toc-backref" href="#id3" name="browsing">Browsing</a></h2>
<p><strong>go</strong> <em>&lt;url&gt;</em> -- visit the given URL.</p>
<p><strong>back</strong> -- return to the previous URL.</p>
<p><strong>reload</strong> -- reload the current URL.</p>
<p><strong>follow</strong> <em>&lt;link name&gt;</em> -- follow the given link.</p>
</div>
<div class="section" id="assertions">
<h2><a class="toc-backref" href="#id4" name="assertions">Assertions</a></h2>
<p><strong>code</strong> <em>&lt;code&gt;</em> -- assert that the last page loaded had this HTTP status,
e.g. <tt class="docutils literal"><span class="pre">code</span> <span class="pre">200</span></tt> asserts that the page loaded fine.</p>
<p><strong>find</strong> <em>&lt;regexp&gt;</em> -- assert that the page contains this regexp.</p>
<p><strong>notfind</strong> <em>&lt;regexp&gt;</em> -- assert that the page <em>does not</em> contain this regexp.</p>
</div>
<div class="section" id="display">
<h2><a class="toc-backref" href="#id5" name="display">Display</a></h2>
<p><strong>show</strong> -- show the current page's HTML.</p>
<p><strong>echo</strong> <em>&lt;string&gt;</em> -- echo the string to the screen via 'print'.</p>
</div>
<div class="section" id="forms">
<h2><a class="toc-backref" href="#id6" name="forms">Forms</a></h2>
<p><strong>showforms</strong> -- show all of the forms on the page.</p>
<p><strong>submit</strong> <em>&lt;n&gt;</em> -- click the n'th submit button.  (Doesn't quite work predictably yet...)</p>
<p><strong>formvalue</strong> <em>&lt;formnum&gt; &lt;fieldname&gt; &lt;value&gt;</em> --- set the given field in the
given form to the given value.</p>
<p><strong>fv</strong> -- abbreviation for 'formvalue'</p>
<p><strong>formclear</strong> -- clear all values in the form.</p>
</div>
<div class="section" id="other-commands">
<h2><a class="toc-backref" href="#id7" name="other-commands">Other commands</a></h2>
<p><strong>extend_with</strong> <em>&lt;module&gt;</em> -- import commands from Python module.</p>
<p><strong>save_cookies</strong> <em>&lt;filename&gt;</em> -- save current cookie jar into a file.</p>
<p><strong>load_cookies</strong> <em>&lt;filename&gt;</em> -- replace current cookie jar with file contents.</p>
<p><strong>getinput</strong> <em>&lt;prompt&gt;</em> -- get keyboard input and store it in <tt class="docutils literal"><span class="pre">__input__</span></tt>.</p>
<p><strong>getpassword</strong> <em>&lt;prompt&gt;</em> -- get <em>silent</em> keyboard input and store
it in <tt class="docutils literal"><span class="pre">__password__</span></tt>.</p>
</div>
</div>
<div class="section" id="availability">
<h1><a class="toc-backref" href="#id8" name="availability">Availability</a></h1>
<p>Version 0.7 (&quot;more things work&quot;) is available for
download <a class="reference" href="http://darcs.idyll.org/~t/projects/twill-0.7.tar.gz">here</a>.  The latest development version can be found at
<a class="reference" href="http://darcs.idyll.org/~t/projects/twill-latest.tar.gz">twill-latest.tar.gz</a>.  There's a darcs repository for the project at
<a class="reference" href="http://darcs.idyll.org/~t/projects/twill/">http://darcs.idyll.org/~t/projects/twill/</a>.</p>
</div>
<div class="section" id="installation-and-examples">
<h1><a class="toc-backref" href="#id9" name="installation-and-examples">Installation and Examples</a></h1>
<p>To install twill, just run</p>
<pre class="literal-block">
python setup.py install
</pre>
<p>To run twill, type 'twill-sh' and try</p>
<pre class="literal-block">
go http://www.python.org/
show
</pre>
<p>You can also run scripts (e.g. the files in <tt class="docutils literal"><span class="pre">examples/</span></tt>) directly by
specifying them on the command line.</p>
<p>There are several examples under the <tt class="docutils literal"><span class="pre">examples/</span></tt> subdirectory.  Included
in the examples is a test of the Quixote demo site, and a script for
clearing out SourceForge Mailman lists.  The latter script makes use of the
(very simple!) extension feature, if you're interested...</p>
</div>
<div class="section" id="implementation-and-extending-twill">
<h1><a class="toc-backref" href="#id10" name="implementation-and-extending-twill">Implementation and Extending Twill</a></h1>
<p>twill is essentially a thin shell around the <a class="reference" href="http://wwwsearch.sf.net/">mechanize</a> package.
All twill commands are implemented in the <tt class="docutils literal"><span class="pre">commands.py</span></tt> file,
and <a class="reference" href="http://pyparsing.sourceforge.net/">pyparsing</a> does the work of translating from the input into
the commands (see <tt class="docutils literal"><span class="pre">parse.py</span></tt>).  Interactive shell work and
readline support is implemented via the <a class="reference" href="http://docs.python.org/lib/module-cmd.html">cmd</a> module from the
Python distribution.</p>
<p>twill is pretty small at the moment, and I'm hoping to keep the core
of it very simple.  Right now it's very easy to extend: just build
a Python module that exports the functions you want to call and
run <tt class="docutils literal"><span class="pre">extend_with</span> <span class="pre">&lt;modulename&gt;</span></tt>.</p>
</div>
<div class="section" id="why-reimplement-pbp">
<h1><a class="toc-backref" href="#id11" name="why-reimplement-pbp">Why Reimplement PBP?</a></h1>
<p>PBP is a great idea, but Cory Dodt (the author of PBP) is focusing on
other things at the moment, and I needed a solid scripting language
for Web testing.  Plus, I wanted to play with mechanize.</p>
</div>
<div class="section" id="future-plans">
<h1><a class="toc-backref" href="#id12" name="future-plans">Future Plans</a></h1>
<p>I'm scratching my own itch with twill at the moment, so development of
the core functionality will proceed sporadically.  Right now I'm
starting to integrate it into my own projects, so expect some of the
following, soon:</p>
<blockquote>
<ul class="simple">
<li>maxq recorder;</li>
<li>more clever wrapping of mechanize;</li>
<li>bug fixes galore.</li>
</ul>
</blockquote>
<p>Contributions are welcome &amp; will be duly acknowledged!</p>
</div>
<div class="section" id="acknowledgements-and-credits">
<h1><a class="toc-backref" href="#id13" name="acknowledgements-and-credits">Acknowledgements and Credits</a></h1>
<p>Cory Dodt had a great idea with PBP, and I thank him for his insight.
Ian Bicking gave me the idea of reimplementing PBP on top of IPython
(since abandoned in favor of <cite>cmd</cite>.)  Grig Gheorghiu was strangely
enthusiastic about the simple demo I showed him.  John J. Lee has
promptly and enthusiastically checked in patches to mechanize.
Michele Simionato is an early adopter who has helped quite a bit.
Thanks, guys...</p>
<pre class="literal-block">
CTB 5/05
</pre>
</div>
</div>
</body>
</html>
